<html>
<head>
	<title>BCA Field Day</title>
	<link rel="stylesheet" type="text/css" href="/static/style.css">
	<script type="text/javascript" src="/static/canvasjs.min.js"></script>

	<script type="text/javascript">
	window.onload = function () {
    // initial values of dataPoints
    var dps = [
    {label: "Management Wing", y: 125}  ,
    {label: "Production Lab", y: 332},
    {label: "Cafeteria", y: 55},
    {label: "Library", y: 46},
    {label: "Recreation Centre", y: 32}
    ];
    var totalEmployees = "total people on campus: 590";

    var chart = new CanvasJS.Chart("chartContainer",{
    	theme:  "theme1",
    	title:{ 
    		text: "People On Campus"
    	},
    	axisY: {        
    		title: "Number of People"
    	},          
    	legend:{
    		verticalAlign: "top",
    		horizontalAlign: "centre",
    		fontSize: 18

    	},
    	data : [{
    		type: "column",
    		showInLegend: true,
    		legendMarkerType: "none",       
    		legendText: totalEmployees,
    		indexLabel: "{y}",
    		dataPoints: dps
    	}]
    });

    // renders initial chart
    chart.render();

    var sum = 590;   //initial sum 

    var updateInterval = 1000;  // milliseconds

    var updateChart = function () {
      // Selecting a random dataPoint
      var dataPointIndex = Math.round(Math.random()*4);   

      // generating random value
      var deltaY = Math.random()*1000;

      // adding random value to random dataPoint
      dps[dataPointIndex].y = (dps[dataPointIndex].y + deltaY) > 0 ? dps[dataPointIndex].y + deltaY : 0 ;

      // updating legend text. 
      sum = sum + deltaY;
      totalEmployees = "total people on campus: " + sum;      
      chart.options.data[0].legendText = totalEmployees;  

      chart.render();
  };
      // update chart after specified interval
      setInterval(function(){updateChart()}, updateInterval);

  } 
  </script>
</head>
<body>
	<div id="top">
		<h1>BCA <strong>FIELD DAY</strong></h1>
		<div class="score" style="color:blue">
			<strong>Blue Team</strong>
			{{blue}}
		</div>
		
		<div class="score" style="color:red">
			<strong>Red Team</strong>
			{{red}}
		</div>
		<div class="score" style="color:yellow">
			<strong>Yellow Team</strong>
			{{yellow}}
		</div>
		<div class="score" style="color:green">
			<strong>Green Team</strong>
			{{green}}
		</div>
		    <div id="chartContainer" style="height:300px; width:100%;">
    </div>
	</div>
	<div id="bottom">
		<table border="1">
			<tr>
				<td> Event Name </td>
				<td> Points </td>
				<td> Team </td>
			</tr>
			{% for event in events %}
			<tr>
				<td> {{ event['event'] }} </td>
				<td> {{ event['points'] }} </td>
				<td> {{ event['team'] }} </td>
			</tr>
			{% endfor %}
		</table>
	</div>
</body>
</html>